<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Support Access to the Aedes Connectome Dataset • aedes</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Support Access to the Aedes Connectome Dataset">
<meta name="description" content="Access to the in progress Aedes aegypti dataset. Organised as a thin wrapper around the fafbseg package. Includes support for adding aedes as a dataset supported by coconatfly.">
<meta property="og:description" content="Access to the in progress Aedes aegypti dataset. Organised as a thin wrapper around the fafbseg package. Includes support for adding aedes as a dataset supported by coconatfly.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">aedes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/flyconnectome/aedes/"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://natverse.org">natverse</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="aedes">aedes<a class="anchor" aria-label="anchor" href="#aedes"></a>
</h1></div>
<!-- badges: start -->

<p>The <strong>aedes</strong> package provides programmatic access to the in progress Aedes aegypti connectome dataset. Note that this dataset is still in an early state of proofreading and annotation and access is currently in a limited pre-release testing phase as we develop a robust community and infrastructure.</p>
<div class="section level2">
<h2 id="implementation-details">Implementation Details<a class="anchor" aria-label="anchor" href="#implementation-details"></a>
</h2>
<p>The package is delivered as a thin wrapper around <a href="https://natverse.org/natverse/fafbseg" class="external-link">fafbseg</a> with optional registration for <a href="https://natverse.org/coconatfly" class="external-link">coconatfly</a>. This will be familiar to users of the <a href="https://github.com/flyconnectome/fancr" class="external-link">fancr</a> and <a href="https://github.com/flyconnectome/bancr" class="external-link">bancr</a> packages.</p>
<p>As a CAVE package you must have access and an appropriate token recorded. Metadata for this project is stored in a seatable web-accessible database accessed via <code>fafbseg::flytable_*</code> functions which are wrapped by this package.</p>
<p>CAVE datasets have a concept of the active <code>materialisation version</code> which defines the state of the segmentation used for analysis. Alternatively a <code>timestamp</code> can be specified to allow an exact point in time to be used.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package must be installed from github:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"natmanager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"natmanager"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">natmanager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span>pkgs <span class="op">=</span> <span class="st">"flyconnectome/aedes"</span><span class="op">)</span></span></code></pre></div>
<p>You also need to do some additional one time setup.</p>
<p>Access to the segmentation / connectivity information is via CAVE. We use the python CAVE client under the hood and this must be installed via <code><a href="https://rdrr.io/pkg/fafbseg/man/simple_python.html" class="external-link">simple_python()</a></code>. Authentication is via a token, which is typically shared across CAVE projects (e.g. flywire, FANC, BANC etc). You can make a new one linked to the email address authorised to access web resources via neuroglancer.</p>
<p>In order to start using flytable, you must get an API token. There doesn’t seem to be a convenient way to do this from the seatable web interface but you can get one by calling <code><a href="https://rdrr.io/pkg/fafbseg/man/flytable_login.html" class="external-link">flytable_set_token()</a></code> with your flytable user and password. This should be a once only step. Thereafter you should have a <code>FLYTABLE_TOKEN</code> environment variable set in your <code>.Renviron</code> file.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># required </span></span>
<span><span class="fu">fafbseg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fafbseg/man/simple_python.html" class="external-link">simple_python</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Will open browser to get new token</span></span>
<span><span class="fu">fafbseg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fafbseg/man/flywire_set_token.html" class="external-link">flywire_set_token</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Writes a known token to correct location</span></span>
<span><span class="fu">fafbseg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fafbseg/man/flywire_set_token.html" class="external-link">flywire_set_token</a></span><span class="op">(</span><span class="st">"2f88e16c4f21bfcb290b2a8288c05bd0"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fafbseg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fafbseg/man/flytable_login.html" class="external-link">flytable_set_token</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup-for-coconatfly">Setup for coconatfly<a class="anchor" aria-label="anchor" href="#setup-for-coconatfly"></a>
</h2>
<p>We recommend using coconatfly for most analysis. At the moment you must tell coconatfly about the aedes dataset once per R session.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/flyconnectome/aedes" class="external-link">aedes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/natverse/coconatfly" class="external-link">coconatfly</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># once per session</span></span>
<span><span class="fu"><a href="reference/register_aedes_coconat.html">register_aedes_coconat</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1) List neurons with class ALPN</span></span>
<span><span class="va">alpn_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://natverse.org/coconatfly/reference/cf_meta.html" class="external-link">cf_meta</a></span><span class="op">(</span><span class="fu"><a href="https://natverse.org/coconatfly/reference/cf_ids.html" class="external-link">cf_ids</a></span><span class="op">(</span>aedes <span class="op">=</span> <span class="st">"/class:ALPN"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">alpn_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">subclass</span>, <span class="va">subsubclass</span><span class="op">)</span></span>
<span><span class="co">#&gt;   subclass subsubclass   n</span></span>
<span><span class="co">#&gt; 1     ALPN      BI_MUL  21</span></span>
<span><span class="co">#&gt; 2     ALPN      BI_UNI   8</span></span>
<span><span class="co">#&gt; 3     ALPN      II_MUL 214</span></span>
<span><span class="co">#&gt; 4     ALPN      II_UNI 329</span></span></code></pre></div>
<p>Select a smaller set of PN neurons with type matching G2X</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gpn_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://natverse.org/coconatfly/reference/cf_meta.html" class="external-link">cf_meta</a></span><span class="op">(</span><span class="fu"><a href="https://natverse.org/coconatfly/reference/cf_ids.html" class="external-link">cf_ids</a></span><span class="op">(</span>aedes <span class="op">=</span> <span class="st">"/type:G2[0-9].*PN"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Updating 3 ids</span></span>
<span><span class="co">#&gt; Updating 245 ids</span></span>
<span><span class="va">gpn_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://natverse.org/coconatfly/reference/cf_meta.html" class="external-link">cf_meta</a></span><span class="op">(</span><span class="va">gpn_ids</span><span class="op">)</span></span>
<span><span class="co">#&gt; Updating 245 ids</span></span>
<span><span class="va">gpn_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">side</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu">spread</span><span class="op">(</span><span class="va">side</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="co">#&gt;        type L  R</span></span>
<span><span class="co">#&gt; 1   G20_lPN 2  2</span></span>
<span><span class="co">#&gt; 2   G21_lPN 3  3</span></span>
<span><span class="co">#&gt; 3  G22_adPN 1  1</span></span>
<span><span class="co">#&gt; 4   G23_lPN 3  3</span></span>
<span><span class="co">#&gt; 5   G24_lPN 2  2</span></span>
<span><span class="co">#&gt; 6   G25_lPN 1  1</span></span>
<span><span class="co">#&gt; 7   G26_lPN 1  1</span></span>
<span><span class="co">#&gt; 8  G27_adPN 1  1</span></span>
<span><span class="co">#&gt; 9  G28_adPN 1  1</span></span>
<span><span class="co">#&gt; 10 G29_adPN 1  1</span></span>
<span><span class="co">#&gt; 11 G29_lvPN 1 NA</span></span></code></pre></div>
<p>Now we can cluster by connectivity. This depends on partner neurons having some kind of identity recorded, typically via the type column (the default) or the numeric group column (which is often set even when a formal type has not been proposed). At the time of writing PN input partners (ORNs) are well typed but downstream partners less so. So let’s just use input partners and also restrict to neurons that have already been typed with n=2 neurons in the type so that we have a small plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gpn_meta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">add_count</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://natverse.org/coconatfly/reference/cf_cosine_plot.html" class="external-link">cf_cosine_plot</a></span><span class="op">(</span>partners <span class="op">=</span> <span class="st">'in'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Updating 245 ids</span></span>
<span><span class="co">#&gt; Updating 245 ids</span></span>
<span><span class="co">#&gt; Warning in coconat::partner_summary2adjacency_matrix(x[["inputs"]], inputcol =</span></span>
<span><span class="co">#&gt; groupcol, : Dropping: 940/1320 neurons representing 12245/27020 synapses due to</span></span>
<span><span class="co">#&gt; missing ids!</span></span>
<span><span class="co">#&gt; Updating 245 ids</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" alt="" width="100%"></p>
<p>There are a wealth of options for the clustering. You can select input partners only or using the group column rather than type for defining the neuron-type connectivity matrix. You can turn off partner grouping (which can actually work better in some circumstances when there is limited partner type information available) but you will not be able to co-cluster L and R homologues.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://natverse.org/coconatfly/reference/cf_cosine_plot.html" class="external-link">cf_cosine_plot</a></span><span class="op">(</span><span class="va">gpn_ids</span>, heatmap <span class="op">=</span> <span class="cn">T</span>, partners <span class="op">=</span> <span class="st">'in'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://natverse.org/coconatfly/reference/cf_cosine_plot.html" class="external-link">cf_cosine_plot</a></span><span class="op">(</span><span class="va">gpn_ids</span>, heatmap <span class="op">=</span> <span class="cn">T</span>, partners <span class="op">=</span> <span class="st">'in'</span>, group <span class="op">=</span> <span class="st">'group'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://natverse.org/coconatfly/reference/cf_cosine_plot.html" class="external-link">cf_cosine_plot</a></span><span class="op">(</span><span class="va">gpn_ids</span>, heatmap <span class="op">=</span> <span class="cn">T</span>, partners <span class="op">=</span> <span class="st">'in'</span>, group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The default threshold setting of 5 synapse may be a little restrictive for this dataset where synapses counts seem to be low (even without considering proofreading).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://natverse.org/coconatfly/reference/cf_cosine_plot.html" class="external-link">cf_cosine_plot</a></span><span class="op">(</span><span class="va">gpn_ids</span>, heatmap <span class="op">=</span> <span class="cn">T</span>, partners <span class="op">=</span> <span class="st">'in'</span>, group <span class="op">=</span> <span class="cn">FALSE</span>, threshold <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Updating 245 ids</span></span>
<span><span class="co">#&gt; Updating 245 ids</span></span>
<span><span class="co">#&gt; Updating 245 ids</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" alt="" width="100%"></p>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<ul>
<li>Access to the Aedes segmentation depends on your CAVE dataset permissions.</li>
<li>Some functions require access to the FlyTable</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/flyconnectome/aedes/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/flyconnectome/aedes/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing aedes</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Gregory Jefferis <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0587-9355" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/flyconnectome/aedes/actions/workflows/pkgdown.yaml" class="external-link"><img src="https://github.com/flyconnectome/aedes/actions/workflows/pkgdown.yaml/badge.svg" alt="docs"></a></li>
<li><a href="https://natverse.github.io" class="external-link"><img src="https://img.shields.io/badge/natverse-Part%20of%20the%20natverse-a241b6" alt="natverse"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/flyconnectome/aedes/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/flyconnectome/aedes/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregory Jefferis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
